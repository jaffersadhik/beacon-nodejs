<!-- This example requires Tailwind CSS v2.0+ -->
<div class="border-b border-gray-200 pt-2 bg-white h-14">
	<div class="flex justify-between">
		<div class="md:flex sm:items-baseline">
			<div class="flex flex-col">
				<h3 class="text-md leading-6 font-bold text-gray-900 md:px-4 pl-2 mt-2 md:text-l">Download Center</h3>
			</div>
			<div class="flex mt-6 md:mt-0 sm:ml-8">
				<nav class="-mb-px flex space-x-6 ml-4 md:ml-0">
					<div routerLink="/downloads/log" class="flex mt-3.5 focus:outline-none">
						<svg xmlns="http://www.w3.org/2000/svg"
							class="h-4 w-4 text-indigo-500 cursor-pointer ml-0.0 mt-0.5 font-bold" fill="none" viewBox="0 0 24 24"
							stroke="currentColor">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
								d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
						</svg>
						<a class="border-indigo-500  cursor-pointer text-indigo-600 whitespace-nowrap pb-2.5 md:pb-3 px-1 ml-0.5 border-b-2 font-medium text-sm"
							aria-current="page"> Log Download </a>
					</div>
					<!-- <div class="flex mt-3.5">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500 cursor-pointer ml-0.0 mt-0.5 font-bold"
							fill="none" viewBox="0 0 24 24" stroke="currentColor">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
								d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
						</svg>
						<a
							class="border-transparent cursor-pointer text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap pb-2.5 md:pb-3 px-1 ml-0.5 border-b-2 font-medium text-sm">
							Group Download </a>
					</div> -->
				</nav>
			</div>
		</div>
		<div class="relative mr-4"></div>
	</div>
</div>
<main class="flex-1 relative overflow-y-auto focus:outline-none" >
	<div class="py-6 relative">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8 mt-10 md:mt-6">
			<!-- Replace with your content -->

			<!-- statistics section skeleton loader -->
			<div *ngIf="statsLoading" class=" max-w-7xl mx-auto px-4 sm:px-6 md:px-8 mt-10 lg:mt-2">
				<div class="grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-x-4 gap-y-3">
					<div class="bg-white dark:bg-gray-800 rounded flex items-center justify-between px-5 relative shadow h-16">
						<div class="bg-gray-200 h-8 w-full animate-pulse"></div>
					</div>
					<div class="bg-white dark:bg-gray-800 rounded flex items-center justify-between px-5 relative shadow h-16">
						<div class="bg-gray-200 h-8 w-full animate-pulse"></div>
					</div>
					<div class="bg-white dark:bg-gray-800 rounded flex items-center justify-between px-5 relative shadow h-16">
						<div class="bg-gray-200 h-8 w-full animate-pulse"></div>
					</div>
					<div class="bg-white dark:bg-gray-800 rounded flex items-center justify-between px-5 relative shadow h-16">
						<div class="bg-gray-200 h-8 w-full animate-pulse"></div>
					</div>
				</div>
			</div>

			<!-- stats -->
			<div *ngIf="!statsLoading"
				class="grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-x-8 gap-y-4">
				<div class="bg-white dark:bg-gray-800 rounded shadow">
					<div class="border-l-4 border-indigo-300 flex items-center justify-between p-3">
						<h3 class="focus:outline-none leading-4 text-gray-800 dark:text-gray-100 font-normal text-base">
							Total <span class="text-xxs text-gray-500">(todays)</span></h3>
						<h2 class="focus:outline-none text-gray-800 dark:text-gray-100 text-2xl leading-normal font-bold">
							{{stats?.total}}</h2>
					</div>
				</div>
				<div class="bg-white dark:bg-gray-800 rounded shadow">
					<div class="border-l-4 border-yellow-300 flex items-center justify-between p-3">
						<h3 class="focus:outline-none leading-4 text-gray-800 dark:text-gray-100 font-normal text-base">
							Inprocess <span class="text-xxs text-gray-500">(todays)</span></h3>
						<h2 class="focus:outline-none text-gray-800 dark:text-gray-100 text-2xl leading-normal font-bold">
							{{stats?.inprocess}}</h2>
					</div>
				</div>
				<div class="bg-white dark:bg-gray-800 rounded shadow">
					<div class="border-l-4 border-green-300 flex items-center justify-between p-3">
						<h3 class="focus:outline-none leading-4 text-gray-800 dark:text-gray-100 font-normal text-base">
							Completed <span class="text-xxs text-gray-500">(todays)</span></h3>
						<h2 class="focus:outline-none text-gray-800 dark:text-gray-100 text-2xl leading-normal font-bold">
							{{stats?.completed}}</h2>
					</div>
				</div>
				<div class="bg-white dark:bg-gray-800 rounded shadow">
					<div class="border-l-4 border-red-300 flex items-center justify-between p-3">
						<h3 class="focus:outline-none leading-4 text-gray-800 dark:text-gray-100 font-normal text-base">
							Failed <span class="text-xxs text-gray-500">(todays)</span></h3>
						<h2 class="focus:outline-none text-gray-800 dark:text-gray-100 text-2xl leading-normal font-bold">
							{{stats?.failed}}</h2>
					</div>
				</div>
			</div>
			<!-- Card code block end -->
			<div class="text-lg font-medium text-gray-700 mt-6">Download Requests</div>

			<!-- download section -->
			<div class="bg-white px-5 py-5 md:px-10 md:py-6 mt-3 rounded">
				<div class="space-y-4">
					<div class="flex flex-col lg:flex-row justify-between lg:items-center pt-1 space-y-2">
						<!-- search -->
						<div class="relative sm:w-1/2">
							<input (keyup)="getcount()" [(ngModel)]="term" type="text" name="name" id="name"
								class="sm:block flex w-full text-xs py-3 pl-10 text-gray-800 placeholder-gray-300 focus:outline-none border-gray-100 bg-opacity-60 bg-gray-100 rounded"
								placeholder="Search" value="" aria-invalid="true" aria-describedby="name-error" />

							<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
								<svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg"
									xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" version="1.1">
									<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
										<rect x="0" y="0" width="24" height="24"></rect>
										<path
											d="M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z"
											fill="currentColor" fill-rule="nonzero" opacity="0.3"></path>
										<path
											d="M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z"
											fill="currentColor" fill-rule="nonzero"></path>
									</g>
								</svg>
							</div>
						</div>
						<!-- filter section -->
						<div class="pt-2 sm:pt-0 w-full flex lg:justify-end">
							<div class="flex justify-between lg:justify-end items-center space-x-2 text-xs w-full">
								<div class="flex space-x-2">
									<app-downloads-calendar (selectedDateEmitter)="receivedDateSelection($event)">
									</app-downloads-calendar>
								</div>
								<div (click)="onSearch()" class="">
									<button
										class="text-white p-2 pr-2.5 border-transparent border bg-blue-600 hover:bg-blue-500 cursor-pointer rounded focus:outline-none focus:ring-2 focus:ring-offset-2">
										<span class="ml-1.5 font-medium">Search</span>
									</button>
								</div>
							</div>
						</div>
					</div>

					<!-- table section -->
					<div class="flex flex-col pt-1">
						<div class="overflow-x-auto">
							<div class="py-2 align-middle inline-block min-w-full pt-3">
								<div class="">
									<table class="min-w-full divide-y-0 divide-gray-200">
										<thead *ngIf="!( noRecords==0 || apiError || noData && downloadReq.length == 0)"
											class="bg-gray-50 text-xxs font-medium text-gray-400">
											<tr class="">
												<th scope="col" class="px-2 py-2 flex items-center text-left uppercase tracking-wider">

													<app-sorter [colTitle]="'From'" [defaultProperty]="defaultProp" [icon]="fromIcon"
														[sortingProperty]="'from'" [defaultOrder]="'dce'" (sortingEmitter)="sort($event)"
														(iconEmitter)="iconChange($event)"></app-sorter>
												</th>
												<th scope="col" class="px-4 py-2 text-left uppercase tracking-wider whitespace-nowrap">
													<app-sorter [colTitle]="'To'" [defaultProperty]="defaultProp" [icon]="toIcon"
														[sortingProperty]="'to'" [defaultOrder]="'dce'" (sortingEmitter)="sort($event)"
														(iconEmitter)="iconChange($event)"></app-sorter>
												</th>
												<th scope="col" class=" py-2 text-left uppercase tracking-wider whitespace-nowrap">
													<app-sorter [colTitle]="'Status'" [defaultProperty]="defaultProp" [icon]="statusIcon"
														[sortingProperty]="'status'" [defaultOrder]="'dce'" (sortingEmitter)="sort($event)"
														(iconEmitter)="iconChange($event)"></app-sorter>
												</th>
												<th scope="col" class=" py-2 text-left uppercase tracking-wider whitespace-nowrap">
													<app-sorter [colTitle]="'Total'" [defaultProperty]="defaultProp" [icon]="totalIcon"
														[sortingProperty]="'total'" [defaultOrder]="'dce'" (sortingEmitter)="sort($event)"
														(iconEmitter)="iconChange($event)"></app-sorter>
												</th>
												<th scope="col" class="px-6 py-2 text-left uppercase tracking-wider whitespace-nowrap">
													Filters</th>
												<th scope="col" class="px-6 py-2 text-center uppercase tracking-wider whitespace-nowrap">
													<app-sorter [colTitle]="createdDateCol" [defaultProperty]="defaultProp" [defaultOrder]="'dce'"
														[icon]="createdTsIcon" [sortingProperty]="'created_ts_unix'" (sortingEmitter)="sort($event)"
														(iconEmitter)="iconChange($event)"></app-sorter>
												</th>
												<th scope="col" class="px-6 py-2 text-center uppercase tracking-wider whitespace-nowrap">
												</th>
											</tr>
										</thead>

										<!-- table data skeleton loader -->
										<app-download-skeleton *ngIf="skeleton"></app-download-skeleton>
										<tbody *ngIf="!(skeleton || apiError || noRecords==0)" class="bg-white divide-y divide-gray-100">
											<tr
												*ngFor="let req of downloadReq | downloadFilter : trimmedTerm | sorter:nameOrder:searchprop | paginate: { itemsPerPage: itemsPerPage, currentPage: p, totalItems: total} ">
												<td class="px-6 py-2 text-xs text-gray-700 leading-5 tracking-wide whitespace-nowrap">
													<div class="flex flex-col justify-center items-center">
														<span class="px-0 rounded-full"> {{req.from}} </span>
													</div>
												</td>
												<td class="px-6 py-2 text-xs text-gray-700 leading-5 tracking-wide whitespace-nowrap">
													<div class="flex flex-col justify-center items-center">
														<span class="px-0 rounded-full"> {{req.to}} </span>
													</div>
												</td>
												<td class="px-6 py-4 whitespace-nowrap">
													<div class="text-xs font-medium tracking-wider text-gray-600">
														<span
															[ngClass]="req.status=='completed'? 'bg-green-100 text-green-800':req.status=='failed'? 'bg-red-100 text-red-800' : 'bg-yellow-100 text-yellow-800' "
															class="inline-flex items-center px-1.5 py-0.5 justify-center rounded-sm text-xxs font-medium ">
															{{req.status}} </span>
													</div>
												</td>
												<td class="px-6 py-2 whitespace-normal">
													<div class="text-xs tracking-wider">
														<div class="items-center justify-center">
															<span class="inline-flex justify-center rounded text-xxs text-gray-600">
																{{req.total}} </span>
														</div>
													</div>
												</td>
												<td class="px-6 py-4 whitespace-normal">
													<div class="text-xs text-gray-600 w-44">{{req.filters }}</div>
												</td>

												<td class="px-8 py-2 text-xs text-gray-700 leading-5 tracking-wide whitespace-nowrap">
													<div class="flex flex-col justify-center items-center">
														<span class="px-2 rounded-full"> {{req.created_ts}}</span>
														<span></span>
													</div>
												</td>

												<td *ngIf="req.status == 'completed'"
													class="px-6 py-2 whitespace-nowrap text-right text-sm font-medium">
													<div *ngIf="!req?.downloadStatus" class="flex items-center">
														
														<a (click)="onDownload(req,req.from,req.to)" class="text-gray-600 dark:text-gray-400 p-2 border-transparent border bg-gray-100 dark:hover:bg-gray-600 dark:bg-gray-700 hover:bg-gray-200 cursor-pointer rounded focus:outline-none focus:ring-offset-2 focus:ring-2"
															href="javascript: void(0)" tooltip="Download file" [options]= "myOptions">
															<svg 	 class="w-4 h-4" viewBox="0 0 24 24" version="1.1">
																<g stroke="none" stroke-width="1" fill="none"
																	fill-rule="evenodd">
																	<rect x="0" y="0" width="24" height="24" />
																	<path
																		d="M2,13 C2,12.5 2.5,12 3,12 C3.5,12 4,12.5 4,13 C4,13.3333333 4,15 4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,13 C20,12.4477153 20.4477153,12 21,12 C21.5522847,12 22,12.4477153 22,13 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 C2,15 2,13.3333333 2,13 Z"
																		fill="currentColor" fill-rule="nonzero" opacity="0.3" />
																	<rect fill="currentColor" opacity="0.3"
																		transform="translate(12.000000, 8.000000) rotate(-180.000000) translate(-12.000000, -8.000000) "
																		x="11" y="1" width="2" height="14" rx="1" />
																	<path
																		d="M7.70710678,15.7071068 C7.31658249,16.0976311 6.68341751,16.0976311 6.29289322,15.7071068 C5.90236893,15.3165825 5.90236893,14.6834175 6.29289322,14.2928932 L11.2928932,9.29289322 C11.6689749,8.91681153 12.2736364,8.90091039 12.6689647,9.25670585 L17.6689647,13.7567059 C18.0794748,14.1261649 18.1127532,14.7584547 17.7432941,15.1689647 C17.3738351,15.5794748 16.7415453,15.6127532 16.3310353,15.2432941 L12.0362375,11.3779761 L7.70710678,15.7071068 Z"
																		fill="currentColor" fill-rule="nonzero"
																		transform="translate(12.000004, 12.499999) rotate(-180.000000) translate(-12.000004, -12.499999) " />
																</g>
															</svg>

														</a>



													</div>
													<!-- loader -->
													<span *ngIf="req?.downloadStatus" class="flex items-center ">
														<svg class="animate-spin text-gray-900" xmlns="http://www.w3.org/2000/svg"
															xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24"
															version="1.1">
															<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
																<g>
																	<polygon points="0 0 24 0 24 24 0 24" />
																</g>
																<path class="opacity-25"
																	d="M12,4 L12,6 C8.6862915,6 6,8.6862915 6,12 C6,15.3137085 8.6862915,18 12,18 C15.3137085,18 18,15.3137085 18,12 C18,10.9603196 17.7360885,9.96126435 17.2402578,9.07513926 L18.9856052,8.09853149 C19.6473536,9.28117708 20,10.6161442 20,12 C20,16.418278 16.418278,20 12,20 C7.581722,20 4,16.418278 4,12 C4,7.581722 7.581722,4 12,4 Z"
																	fill="currentColor" fill-rule="nonzero"
																	transform="translate(12.000000, 12.000000) scale(-1, 1) translate(-12.000000, -12.000000) " />
															</g>
														</svg>

													</span>
												</td>
											</tr>
										</tbody>


									</table>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- section to show no data for search -->
				<app-nodataerror *ngIf="noRecords==0 && ! skeleton && !apiError" [title]="'download request'">
				</app-nodataerror>

				<!-- section to show on no records -->
				<div *ngIf="noData && downloadReq.length == 0 && !(noRecords==0)"
					class="flex items-start justify-between max-w-7xl min-h-screen mx-auto px-4 sm:px-6 md:px-8 mt-6">
					<div class="w-full flex flex-col items-center justify-start bg-white">
						<div class="mt-8">
							<p class="text-2xl text-gray-700 font-semibold">
								SORRY!
							</p>
						</div>
						<div class="mt-6 w-2/3 lg:w-2/5 text-center">
							<p class="text-md text-gray-400 font-medium">
								There is no request added for Selected Date Range!

							</p>
						</div>
						<div class="mt-10 text-center justify-center items-center">
							<button routerLink="/reports/detailed"
								class="text-white md:flex md:items-center p-2 px-3.5 border-transparent border bg-blue-500 hover:bg-blue-400 cursor-pointer rounded focus:outline-none focus:border-gray-800 focus:shadow-outline-gray">
								<span class="font-medium text-sm flex">Download Request</span>
							</button>
						</div>
						<div class="mt-24 text-center justify-center items-center md:w-1/2">
							<img src="/cm/assets/hosting.png" class="object-cover w-auto h-auto md:w-full md:h-72" alt="" srcset="" />
						</div>
					</div>
				</div>
				<!-- section to show on API error -->
				<app-apierror *ngIf="apiError && ! skeleton && ! noData" (Emitter)="onSearch()"> </app-apierror>

				<!-- page navigation section -->
				<app-file-pagination *ngIf="!(apiError ||  noData && downloadReq.length == 0 || noRecords==0 || skeleton)"
					[total]="total" [totalRecord]="totalRecord" [p]="p" [pagesize]="pagesize" [itemsPerPage]="itemsPerPage"
					[perpageCount]="perpageCount" (paginationValueEmit)="ReceivedpaginateValue($event)">
				</app-file-pagination>

			</div>

			<!-- /End replace -->
		</div>
	</div>
</main>